#!/usr/bin/env python3
"""
р╕Чр╕Фр╕кр╕нр╕Ъ Text-to-Speech р╕нр╕вр╣Ир╕▓р╕Зр╕Зр╣Ир╕▓р╕в
"""

print("ЁЯФК р╕Чр╕Фр╕кр╕нр╕Ъ Text-to-Speech")
print("=" * 50)

# р╕Чр╕Фр╕кр╕нр╕Ъ 1: pyttsx3 р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╕лр╕гр╕╖р╕нр╕вр╕▒р╕З
try:
    import pyttsx3
    print("тЬУ pyttsx3 р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╣Бр╕ер╣Йр╕з")
except ImportError:
    print("тЭМ pyttsx3 р╣Др╕бр╣Ир╣Др╕Фр╣Йр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З")
    print("р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╕Фр╣Йр╕зр╕в: pip install pyttsx3")
    exit(1)

# р╕Чр╕Фр╕кр╕нр╕Ъ 2: р╕кр╕гр╣Йр╕▓р╕З engine
try:
    print("\nЁЯФз р╕Бр╕│р╕ер╕▒р╕Зр╕кр╕гр╣Йр╕▓р╕З TTS engine...")
    engine = pyttsx3.init()
    print("тЬУ р╕кр╕гр╣Йр╕▓р╕З engine р╕кр╕│р╣Ар╕гр╣Зр╕И")
except Exception as e:
    print(f"тЭМ р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╕гр╣Йр╕▓р╕З engine: {e}")
    exit(1)

# р╕Чр╕Фр╕кр╕нр╕Ъ 3: р╕Фр╕╣ voices р╕Чр╕╡р╣Ир╕бр╕╡
try:
    voices = engine.getProperty('voices')
    print(f"\nЁЯУв р╕Юр╕Ъ {len(voices)} р╣Ар╕кр╕╡р╕вр╕З:")
    for i, voice in enumerate(voices[:3]):
        print(f"  {i+1}. {voice.name}")
except Exception as e:
    print(f"тЭМ р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Фр╕╣ voices: {e}")

# р╕Чр╕Фр╕кр╕нр╕Ъ 4: р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓
try:
    engine.setProperty('rate', 150)
    engine.setProperty('volume', 0.9)
    print("\nтЬУ р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Ар╕кр╕гр╣Зр╕Ир╣Бр╕ер╣Йр╕з")
except Exception as e:
    print(f"тЭМ р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓: {e}")

# р╕Чр╕Фр╕кр╕нр╕Ъ 5: р╕Юр╕╣р╕Ф
print("\nЁЯФК р╕Бр╕│р╕ер╕▒р╕Зр╕Юр╕╣р╕Ф...")
print("р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б: 'р╕кр╕зр╕▒р╕кр╕Фр╕╡р╕Др╕гр╕▒р╕Ъ р╕Щр╕╡р╣Ир╕Др╕╖р╕нр╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ър╣Ар╕кр╕╡р╕вр╕Зр╕Юр╕╣р╕Ф'")
print()

try:
    test_text = "р╕кр╕зр╕▒р╕кр╕Фр╕╡р╕Др╕гр╕▒р╕Ъ р╕Щр╕╡р╣Ир╕Др╕╖р╕нр╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ър╣Ар╕кр╕╡р╕вр╕Зр╕Юр╕╣р╕Ф"
    engine.say(test_text)
    engine.runAndWait()
    print("тЬУ р╕Юр╕╣р╕Фр╣Ар╕кр╕гр╣Зр╕Ир╣Бр╕ер╣Йр╕з!")
    print()
except Exception as e:
    print(f"тЭМ р╣Ар╕Бр╕┤р╕Фр╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Ф: {e}")
    exit(1)

# р╕кр╕гр╕╕р╕Ы
print("=" * 50)
print("тЬЕ Text-to-Speech р╕Чр╕│р╕Зр╕▓р╕Щр╕Ыр╕Бр╕Хр╕┤")
print()
print("р╕Цр╣Йр╕▓р╣Др╕Фр╣Йр╕вр╕┤р╕Щр╣Ар╕кр╕╡р╕вр╕З = р╕гр╕░р╕Ър╕Ър╕Юр╕гр╣Йр╕нр╕бр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ")
print("р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╣Др╕Фр╣Йр╕вр╕┤р╕Щ = р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ:")
print("  1. р╕ер╕│р╣Вр╕Юр╕Зр╣Ар╕Ыр╕┤р╕Фр╕нр╕вр╕╣р╣Ир╕лр╕гр╕╖р╕нр╣Др╕бр╣И")
print("  2. р╕гр╕░р╕Фр╕▒р╕Ър╣Ар╕кр╕╡р╕вр╕Зр╣Гр╕Щр╕гр╕░р╕Ър╕Ъ")
print("  3. Output device р╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╕лр╕гр╕╖р╕нр╣Др╕бр╣И")
print()

# р╕Чр╕Фр╕кр╕нр╕Ър╣Ар╕Юр╕┤р╣Ир╕б
if input("р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ър╕нр╕╡р╕Бр╕Др╕гр╕▒р╣Йр╕Зр╕лр╕гр╕╖р╕нр╣Др╕бр╣И? (y/n): ").lower() == 'y':
    text = input("р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Юр╕╣р╕Ф: ")
    if text:
        engine.say(text)
        engine.runAndWait()
        print("тЬУ р╣Ар╕кр╕гр╣Зр╕Ир╣Бр╕ер╣Йр╕з")