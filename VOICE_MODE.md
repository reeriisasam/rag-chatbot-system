# 🎤 Voice Mode Guide

คู่มือการใช้งานโหมดเสียงแบบต่อเนื่อง

## 🌟 ฟีเจอร์

### 1. โหมดสนทนาเสียงต่อเนื่อง
- กดปุ่ม **🎤 Voice** เพื่อเริ่มโหมดสนทนา
- ระบบจะฟังและตอบกลับเป็นเสียงอัตโนมัติ
- สนทนาต่อเนื่องได้โดยไม่ต้องกดปุ่มซ้ำ

### 2. Voice Visualization
- แสดง waveform animation เมื่อกำลังฟัง/พูด
- บาร์เสียงกระพริบเป็นจังหวะ
- สีสลับกัน (ฟ้า/เขียว)

### 3. ปุ่มควบคุม
- **🎤 Voice** → เริ่มโหมดเสียง (เปลี่ยนเป็น ⏹️ Stop Voice)
- **⏹️ Stop Voice** → หยุดโหมดเสียง
- **🔇 Stop** → หยุดการพูดทันที

## 📖 วิธีใช้งาน

### วิธีที่ 1: สนทนาครั้งเดียว (Text Mode)

```
1. อยู่ใน Text Mode
2. คลิกปุ่ม 🎤 Voice
3. พูดคำถาม
4. Bot จะตอบเป็นข้อความและเสียง
5. เสร็จสิ้น
```

### วิธีที่ 2: สนทนาต่อเนื่อง (Voice Mode) ⭐

```
1. คลิกปุ่ม 📝 Text Mode เพื่อสลับเป็น 🎤 Voice Mode
2. คลิกปุ่ม 🎤 Voice (จะเปลี่ยนเป็น ⏹️ Stop Voice)
3. พูดคำถามแรก
4. Bot ตอบกลับเป็นเสียง
5. ระบบจะฟังต่อโดยอัตโนมัติ
6. พูดคำถามต่อไป
7. วนซ้ำได้เรื่อยๆ
8. พูด "หยุด" หรือคลิก ⏹️ Stop Voice เพื่อจบ
```

## 🎯 ตัวอย่างการใช้งาน

### Scenario 1: ถาม-ตอบครั้งเดียว

```
Mode: Text 📝

[คลิก 🎤 Voice]
🎤 กำลังฟัง... [แถบเสียงกระพริบ]

You: "สวัสดีครับ"
🔊 กำลังพูด... [แถบเสียงกระพริบ]
Bot: "สวัสดีครับ! มีอะไรให้ช่วยไหมครับ?"
[พูดเสร็จ]
```

### Scenario 2: สนทนาต่อเนื่อง (แนะนำ)

```
[คลิก 📝 Text Mode → เปลี่ยนเป็น 🎤 Voice Mode]
Mode: Voice 🎤

[คลิก 🎤 Voice]
ปุ่มเปลี่ยนเป็น: ⏹️ Stop Voice

🎤 เริ่มโหมดสนทนาเสียง

🎤 กำลังฟัง... [แถบเสียงกระพริบ]
You: "สวัสดีครับ"
🔊 กำลังพูด... [แถบเสียงกระพริบ]
Bot: "สวัสดีครับ! มีอะไรให้ช่วยไหมครับ?"

🎤 กำลังฟัง... [แถบเสียงกระพริบ]
You: "วันนี้อากาศเป็นอย่างไร"
🔊 กำลังพูด... [แถบเสียงกระพริบ]
Bot: "วันนี้อากาศดีครับ แดดจัดหน่อย"

🎤 กำลังฟัง... [แถบเสียงกระพริบ]
You: "หยุด"
⏹️ หยุดโหมดสนทนาเสียงแล้ว
```

## 🎨 UI Elements

### สถานะต่างๆ

| สถานะ | ข้อความ | สี | Visualization |
|-------|---------|-----|---------------|
| ฟังเสียง | 🎤 กำลังฟัง... | ฟ้า | แถบเสียงกระพริบ |
| กำลังพูด | 🔊 กำลังพูด... | ฟ้า | แถบเสียงกระพริบ |
| ปกติ | - | - | ไม่มี |

### ปุ่มต่างๆ

```
┌─────────────────────────────────────────┐
│ 🤖 RAG Chatbot    Mode: Voice  ● Online │
├─────────────────────────────────────────┤
│                                         │
│         [Chat Area]                     │
│                                         │
├─────────────────────────────────────────┤
│ [Input]                    [Send ➤]    │
│                            [⏹️ Stop]    │
├─────────────────────────────────────────┤
│ 🗑️ Clear  🎤 Voice Mode  📊 Stats      │
│ 🎤 กำลังฟัง... [████▌▂▄▆] 🔇 Stop     │
└─────────────────────────────────────────┘
```

## ⌨️ คำสั่งเสียง

### คำสั่งหยุดสนทนา
พูดคำใดคำหนึ่ง:
- **"หยุด"**
- **"ออก"**
- **"จบ"**
- **"stop"**
- **"exit"**
- **"quit"**
- **"ปิด"**

### คำถามทั่วไป
- "สวัสดี"
- "คุณเป็นใครครับ"
- "ช่วยอธิบาย..."
- "หาข้อมูลเกี่ยวกับ..."

## 🔧 การตั้งค่า

### ปรับความไวของไมโครโฟน

ในไฟล์ `config.yaml`:

```yaml
audio:
  stt:
    engine: "google"  # หรือ "whisper"
    timeout: 10       # รอฟังเสียงนานสุด (วินาที)
    phrase_limit: 10  # ฟังต่อเนื่องนานสุด (วินาที)
```

### ปรับความเร็วการพูด

```yaml
audio:
  tts:
    rate: 150    # ความเร็ว (50-300)
    volume: 0.9  # ระดับเสียง (0.0-1.0)
```

## 💡 Tips & Tricks

### 1. พูดชัดๆ
- พูดให้ชัด ไม่เร็วหรือช้าเกินไป
- อยู่ใกล้ไมโครโฟน (30-50 cm)
- หลีกเลี่ยงเสียงรบกวน

### 2. รอให้ Bot พูดจบ
- ระบบจะรอให้ Bot พูดจบก่อนฟังใหม่
- ถ้าอยากข้าม คลิก 🔇 Stop

### 3. ใช้โหมดเสียงต่อเนื่อง
- สะดวกกว่าการกดปุ่มทุกครั้ง
- เหมาะกับการสนทนายาวๆ

### 4. คำถามสั้นๆ ชัดเจน
- "อากาศวันนี้เป็นอย่างไร"
- "หาข้อมูลเกี่ยวกับ Python"
- "อธิบาย Machine Learning"

## 🐛 การแก้ปัญหา

### ปัญหา: ฟังไม่ได้
```
เหตุผล: ไม่มี PyAudio
แก้ไข: pip install pipwin && pipwin install pyaudio
```

### ปัญหา: พูดไม่ได้
```
เหตุผล: ไม่มี pyttsx3
แก้ไข: pip install pyttsx3
```

### ปัญหา: ระบบไม่เข้าใจ
```
เหตุผล: เสียงไม่ชัด
แก้ไข: 
  1. พูดให้ชัดขึ้น
  2. ลดเสียงรบกวน
  3. เข้าใกล้ไมโครโฟน
```

### ปัญหา: Loop ไม่หยุด
```
เหตุผล: ไม่ได้ยินคำสั่งหยุด
แก้ไข: คลิกปุ่ม ⏹️ Stop Voice
```

## 🎬 Demo Flow

```
1. เปิดโปรแกรม
   python main_gui.py

2. สลับเป็น Voice Mode
   [คลิก 📝 Text Mode]
   → เปลี่ยนเป็น 🎤 Voice Mode

3. เริ่มสนทนา
   [คลิก 🎤 Voice]
   → ปุ่มเปลี่ยนเป็น ⏹️ Stop Voice
   → เห็น "🎤 กำลังฟัง..." พร้อมแถบเสียง

4. พูดคำถาม
   "สวัสดีครับ"
   → Bot ตอบเป็นเสียง
   → แสดง "🔊 กำลังพูด..." พร้อมแถบเสียง

5. สนทนาต่อ
   [พูดคำถามใหม่]
   → Bot ตอบต่อ
   → วนไปเรื่อยๆ

6. จบการสนทนา
   พูด: "หยุด"
   หรือคลิก: ⏹️ Stop Voice
```

## 📚 เพิ่มเติม

- [AUDIO_SETUP.md](AUDIO_SETUP.md) - วิธีติดตั้ง audio packages
- [test_audio.py](test_audio.py) - ทดสอบระบบเสียง
- [GUI_USAGE.md](GUI_USAGE.md) - คู่มือ GUI ทั่วไป

---

**หมายเหตุ:** Voice Mode ใช้งานได้ดีที่สุดในที่เงียบและมีไมโครโฟนคุณภาพดี